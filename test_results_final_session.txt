============================= test session starts ==============================
platform darwin -- Python 3.13.2, pytest-8.4.2, pluggy-1.6.0
benchmark: 5.2.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /Users/doughnut/GitHub/voiage
configfile: pyproject.toml
plugins: mock-3.15.1, asyncio-1.2.0, anyio-4.11.0, xdist-3.8.0, timeout-2.4.0, vcr-1.0.2, jaxtyping-0.3.2, dash-3.2.0, logfire-4.10.0, playwright-0.7.0, ipywidgets-1.49.0, hypothesis-6.143.0, benchmark-5.2.0, base-url-2.1.0, typeguard-4.4.4, cov-7.0.0, syrupy-5.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 39 items

test_phase2_integration.py FF.F..............F...F.F..............       [100%]

=================================== FAILURES ===================================
/Users/doughnut/GitHub/voiage/test_phase2_integration.py:101: assert Array(7.77545338, dtype=float64, weak_type=True) <= 5.0
/Users/doughnut/GitHub/voiage/test_phase2_integration.py:115: assert Array(17278.78528789, dtype=float64, weak_type=True) <= 6000.0
/Users/doughnut/GitHub/voiage/test_phase2_integration.py:126: assert False
/Users/doughnut/GitHub/voiage/test_phase2_integration.py:446: assert False
/Users/doughnut/miniconda3/lib/python3.13/site-packages/jax/_src/dtypes.py:385: TypeError: Cannot interpret '0.1' as a data type
/Users/doughnut/GitHub/voiage/test_phase2_integration.py:529: assert False
================================ tests coverage ================================
_______________ coverage: platform darwin, python 3.13.2-final-0 _______________

Name                                         Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------
voiage/analysis.py                             412    375     9%   26-27, 36-39, 56-98, 116-147, 158-172, 176-180, 193-196, 206-208, 212-216, 231-273, 277-297, 306-333, 343-346, 356-359, 397-485, 499-530, 579-749, 790-874, 888-910, 914-933
voiage/backends/__init__.py                      5      5     0%   5-18
voiage/backends/advanced_integration.py         23     23     0%   5-43
voiage/backends/advanced_jax_regression.py      57     57     0%   2-92
voiage/backends/enhanced_jax_backend.py         85     85     0%   4-149
voiage/backends/gpu_acceleration.py             33     33     0%   3-65
voiage/backends/performance_profiler.py         48     48     0%   3-95
voiage/cli.py                                   44     44     0%   11-172
voiage/clinical_trials.py                      323    102    68%   230, 352-359, 363-385, 393-414, 424, 433, 471-478, 482-489, 494-495, 500, 553-563, 595-619, 661-663, 686, 690-691, 702, 707-709, 713-719, 723-727, 733-752, 819-824
voiage/config_objects.py                       161    161     0%   3-300
voiage/core/gpu_acceleration.py                176    176     0%   3-378
voiage/core/io.py                               59     59     0%   3-140
voiage/core/memory_optimization.py             144    144     0%   3-372
voiage/core/utils.py                            60     53    12%   39-77, 113-185, 205-221
voiage/ecosystem_integration.py                301    187    38%   59-107, 119-154, 158-183, 207-246, 260-328, 340-365, 391-411, 446, 479-494, 498-521, 525, 683-684, 718, 760-761, 784-797, 807, 810-811, 813-815, 876-877, 883-884, 890-891, 896-899
voiage/environmental/__init__.py                 2      2     0%   3-11
voiage/environmental/impact_assessment.py       48     48     0%   3-171
voiage/factory.py                               30     30     0%   3-305
voiage/financial/__init__.py                     2      2     0%   3-11
voiage/financial/risk_analysis.py               68     68     0%   3-224
voiage/fluent.py                                53     53     0%   3-249
voiage/health_economics.py                     153     32    79%   73, 96, 106, 136, 222-237, 403-423, 427-445, 470, 507, 516
voiage/healthcare/__init__.py                    2      2     0%   3-11
voiage/healthcare/utilities.py                  86     86     0%   3-235
voiage/hta_integration.py                      323     59    82%   201, 214-215, 223-224, 231-237, 242-247, 254-255, 268-271, 278-279, 285, 340-342, 351-352, 413-420, 424-429, 449, 465, 487-489, 540, 545, 550, 562, 564, 636, 638, 642, 657, 676, 717
voiage/main_backends.py                        263    221    16%   19, 28-45, 55-58, 67, 84-85, 93-105, 109-137, 142-199, 207-260, 264-275, 279-298, 303-329, 334-346, 351-411, 422-457, 461, 465-468, 472-477, 487-490, 498-511, 515-517, 539-545, 551-553
voiage/metamodels.py                           551    551     0%   5-1152
voiage/methods/adaptive.py                     221    221     0%   53-724
voiage/methods/basic.py                         55     55     0%   9-160
voiage/methods/calibration.py                  117    117     0%   53-496
voiage/methods/network_nma.py                  214    214     0%   52-812
voiage/methods/observational.py                 90     90     0%   54-406
voiage/methods/portfolio.py                    116    116     0%   48-402
voiage/methods/sample_information.py           113    113     0%   8-245
voiage/methods/sequential.py                    99     99     0%   12-299
voiage/methods/structural.py                   141    141     0%   17-389
voiage/multi_domain.py                         279     80    71%   184, 201-216, 220-229, 242, 255, 297, 334, 374, 413, 417, 430, 443, 456, 490-522, 534-568, 572-590, 596, 604-627, 657, 662-672
voiage/parallel/__init__.py                      2      2     0%   3-9
voiage/parallel/monte_carlo.py                 119    119     0%   3-336
voiage/plot/ceac.py                             59     59     0%   3-156
voiage/plot/voi_curves.py                      142    142     0%   5-364
voiage/schema.py                               210    142    32%   23-25, 36-45, 52, 57-59, 64, 69, 74, 89-112, 126-154, 167-170, 177, 182-184, 189, 194, 209-253, 267-310, 338-341, 364-372, 379, 407-412, 438-457, 482-487
voiage/stats.py                                 11     11     0%   5-48
--------------------------------------------------------------------------
TOTAL                                         5543   4427    20%

6 files skipped due to complete coverage.
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED test_phase2_integration.py::TestHealthEconomics::test_qaly_calculation
FAILED test_phase2_integration.py::TestHealthEconomics::test_cost_calculation
FAILED test_phase2_integration.py::TestHealthEconomics::test_net_monetary_benefit
FAILED test_phase2_integration.py::TestClinicalTrialDesign::test_sample_size_optimizer
FAILED test_phase2_integration.py::TestClinicalTrialDesign::test_trial_outcome_simulation
FAILED test_phase2_integration.py::TestClinicalTrialDesign::test_trial_voi_calculation
========================= 6 failed, 33 passed in 9.68s =========================
